# 07. 運用設計（概要）

> ※監視しきい値などの詳細は「運用設計書（別文書）」に記載

---

## 1. 運用方針の全体像

- フルマネージドサービスを中心に構成し、保守負荷を極小化
- バッチ処理・分析処理はLambda／Glueで自動実行
- 定常監視はCloudWatch、操作ログ監査はCloudTrailで実施
- コスト最適化方針（Redshiftの自動停止など）は別途運用設計書に記載

---

## 2. 監視設計（概要）

| 対象          | 手段               | 通知 | 備考                       |
|---------------|--------------------|------|----------------------------|
| Lambda実行    | CloudWatch Logs    | -    | エラー検知は運用対象       |
| Glue失敗      | CloudWatch Events  | SNS  | 異常検知と通知あり         |
| Redshift      | メトリクス＋STLログ| -    | CPU・メモリ・スロークエリ等 |
| S3バケット操作 | CloudTrail         | -    | 重要操作ログを収集         |
| GuardDuty     | 検知イベント       | SNS  | セキュリティインシデント   |

> しきい値や通知先の詳細は運用設計書で定義

---

## 3. 障害時の対応方針（概要）

| 想定障害                     | 初動対応           |
|-----------------------------|------------------|
| Lambda実行失敗               | 通知＋手動再実行  |
| Glueジョブ失敗               | 通知＋手動再実行  |
| S3アクセス異常                | CloudTrailで調査 |
| QuickSightデータセット更新失敗 | 通知＋手動再実行 |

> 夜間/早朝実行のため、翌営業日の対応を基本としている。

---

## 4. バックアップと復旧（概要）

| 対象              | 方法                           | 保持期間       | 備考                              |
|-------------------|--------------------------------|----------------|-----------------------------------|
| Redshift          | 自動スナップショット           | 7日（毎日AM1時）| 手動スナップショットも必要に応じて実施 |
| S3（重要バケット）| バージョニング／ライフサイクル管理 | オブジェクトごと | 通常は復旧不要設計                 |
| Glue Job          | 定義自体はコードで管理         | -              | 再作成可能                         |

---

## 5. 定期運用タスク（抜粋）

| 項目                | 実施者         | 頻度     |
|---------------------|----------------|----------|
| ユーザー権限の確認    | Lambda   | 月次     |
| Redshift起動        | EventBridge    | 毎朝X:XX |
| Redshift停止        | EventBridge    | 毎晩X:XX |
| ETL処理実行          | EventBridge | 毎朝X:XX     |

※運用スケジュールはパフォーマンステストの結果も含め検討

[前の章へ](06_security.md)｜[目次へ](README.md)
